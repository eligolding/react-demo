<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Tweeter</title>
    <link rel="stylesheet" href="assets/bootstrap.min.css">
    <style type="text/css">
        body {
            background: #F5F8FA;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="page-header">
        <h1>Tweeter</h1>
    </div>
    <div class="row">
        <div class="col-md-3 panel panel-default">
            <div id="userInfo" class="clearfix">
                <div class="pull-left"><img id="avatar" /></div>
                <div id="name"></div>
            </div>
        </div>
        <div class="col-md-6 well">
            <textarea id="tweet-box" class="form-control"></textarea>
            <br/>
            <span id="remaining-chars">140</span>
            <button id="tweet-btn" class="btn btn-primary pull-right" disabled>Tweet</button>
        </div>
    </div>
    <div class="row">
        <div class="col-md-offset-3 col-md-6">
            <ul id="tweet-list" class="list-group">

            </ul>
        </div>
    </div>
</div>
<script>
var user = {
    name: 'Eli Golding',
    email: 'eligolding@gmail.com',
    avatar: 'http://www.gravatar.com/avatar/ecbcfd9ce849af543b91a23cd8267737'
};

var userNameEl = document.getElementById('name');
var avatarEl = document.getElementById('avatar');
var tweetBox = document.getElementById('tweet-box');
var tweetButton = document.getElementById('tweet-btn');
var remainingCharsDisplay = document.getElementById('remaining-chars');
var tweetList = document.getElementById('tweet-list');

userNameEl.innerText = user.name;
avatarEl.src = user.avatar;

tweetBox.addEventListener('input', function () {
    var valueLength = this.value.length;
    var remainingChars = 140 - valueLength;
    remainingCharsDisplay.innerText = remainingChars;
    tweetButton.disabled = !valueLength;
    remainingCharsDisplay.style.color = remainingChars < 0 ? 'red' : 'black';
});

tweetButton.addEventListener('click', function () {

    var tweet = {
        username: user.name,
        email: user.email,
        avatar: user.avatar,
        dateTime: (new Date()).toLocaleDateString() + ' ' + (new Date()).toLocaleTimeString(),
        msg: tweetBox.value.substring(0, 140)
    };

    var newTweetEl = document.createElement('li');
    newTweetEl.setAttribute('class', 'list-group-item clearfix');

    newTweetEl.innerHTML =
            '<div class="pull-left" style="margin-right: 10px"><img src="' + tweet.avatar + '"></div>' +
            '<p class="small">' + tweet.username + ' ' + tweet.dateTime + '</p>' +
            '<p class="lead">' + tweet.msg + '</p>' +
            '<a class="delete pull-right">delete</a>';

    tweetList.insertBefore(newTweetEl, tweetList.firstChild);

    tweetBox.value = '';
    tweetBox.focus();
    remainingCharsDisplay.innerText = '140';
    remainingCharsDisplay.style.color = 'black';

    this.disabled = true;
});

tweetList.addEventListener('click', function (e) {
    var target = e.target;
    if (target.className.indexOf('delete') < 0) {
        return false;
    }
    var tweet = target.parentNode;
    this.removeChild(tweet);
    tweetBox.focus();
});
</script>
</body>
</html>
